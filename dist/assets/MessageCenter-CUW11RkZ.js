import{j as e,r as i}from"./react-core-BwkdTuSg.js";import{a as ye,n as Ne,s as d,B as X,h as g,L as p,z as Y,S,o as k,p as D,q as F,r as o,I as U,l as _e}from"./index-CGvwOXPh.js";import{D as we}from"./DataTable-Cv4Bf9qm.js";import{A as Z,f as ee,a as se,b as te,c as ae,d as re}from"./AdminDialog-CFXz2Dfn.js";import{k as m}from"./vendor-D410aui4.js";import{c as E,t as le,o as ne,Q as ie,ay as Ce,a3 as K,U as Se,az as ke,w as ce,K as De,ah as Fe,aw as Me}from"./lucide-icons-CAeZOOE5.js";import"./radix-ui-omyR4zpf.js";import"./supabase-C8Oa5ukG.js";import"./table-BXx61AEI.js";function Oe({user:w}){const{t:r}=ye();if(w.level>6)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(E,{className:"h-12 w-12 text-yellow-500 mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:r.messageCenter.accessDenied})]})});const[de,W]=i.useState(!0),[oe,H]=i.useState([]),[c,P]=i.useState("received"),[M,me]=i.useState("all"),[T,xe]=i.useState("all"),[y,pe]=i.useState(""),[Q,N]=i.useState(!1),[f,I]=i.useState(null),[ue,z]=i.useState(!1),[h,O]=i.useState([]),[R,q]=i.useState([]),[C,L]=i.useState(""),[he,G]=i.useState(!1),[a,u]=i.useState({recipient_type:"user",recipient_username:"",broadcast_type:"single",selected_users:[],title:"",content:"",message_type:"normal"}),[A,V]=i.useState(""),{lastMessage:$,sendMessage:J}=Ne();i.useEffect(()=>{const s=d.channel("messages-changes").on("postgres_changes",{event:"*",schema:"public",table:"messages"},t=>{console.log("ğŸ”” ë©”ì‹œì§€ í…Œì´ë¸” ë³€ê²½ ê°ì§€:",t),_()}).subscribe();return()=>{d.removeChannel(s)}},[]),i.useEffect(()=>{if(!C.trim())q(h);else{const s=h.filter(t=>t.username.toLowerCase().includes(C.toLowerCase()));q(s)}},[C,h]);const ge=async()=>{try{G(!0);const s=a.recipient_type==="user"?"users":"partners",{data:t,error:n}=await d.from(s).select("id, username").order("username");if(n)throw n;O(t||[]),q(t||[]),L("")}catch(s){console.error("ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:",s),m.error(r.messageCenter.loadUsersFailed)}finally{G(!1)}},_=async()=>{try{W(!0);let s=d.from("messages").select("*").order("created_at",{ascending:!1});if(c==="received"?s=s.eq("receiver_type","partner").eq("receiver_id",w.id):s=s.eq("sender_type","partner").eq("sender_id",w.id),M!=="all"&&(s=s.eq("message_type",M)),T!=="all"){const l=T==="read";s=s.eq("status",l?"read":"unread")}y&&(s=s.or(`subject.ilike.%${y}%,content.ilike.%${y}%`));const{data:t,error:n}=await s;if(n)throw n;const x=await Promise.all((t||[]).map(async l=>{const{count:b}=await d.from("messages").select("*",{count:"exact"}).eq("parent_id",l.id);let j="ì•Œ ìˆ˜ ì—†ìŒ";if(l.sender_type==="user"){const{data:v}=await d.from("users").select("username").eq("id",l.sender_id).single();j=v?.username||"ì‚¬ìš©ì"}else if(l.sender_type==="partner"){const{data:v}=await d.from("partners").select("username").eq("id",l.sender_id).single();j=v?.username||"ê´€ë¦¬ì"}let B="ì•Œ ìˆ˜ ì—†ìŒ";if(l.receiver_type==="user"){const{data:v}=await d.from("users").select("username").eq("id",l.receiver_id).single();B=v?.username||"ì‚¬ìš©ì"}else if(l.receiver_type==="partner"){const{data:v}=await d.from("partners").select("username").eq("id",l.receiver_id).single();B=v?.username||"ê´€ë¦¬ì"}return{id:l.id,sender_type:l.sender_type,sender_id:l.sender_id,sender_username:j,recipient_type:l.receiver_type,recipient_id:l.receiver_id,recipient_username:B,title:l.subject,content:l.content,message_type:l.message_type,is_read:l.status==="read",read_at:l.read_at,parent_message_id:l.parent_id,created_at:l.created_at,reply_count:b||0}}));H(x)}catch(s){console.error("ë©”ì‹œì§€ ì¡°íšŒ ì˜¤ë¥˜:",s),m.error(r.messageCenter.loadMessagesFailed)}finally{W(!1)}},je=async s=>{try{const{error:t}=await d.from("messages").update({status:"read",read_at:new Date().toISOString()}).eq("id",s).eq("status","unread");if(t)throw t;H(n=>n.map(x=>x.id===s?{...x,is_read:!0,read_at:new Date().toISOString()}:x))}catch(t){console.error("ë©”ì‹œì§€ ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:",t)}},be=async()=>{if(!a.content.trim()){m.error(r.messageCenter.enterMessageContent);return}if(a.broadcast_type==="single"&&!a.recipient_username.trim()){m.error(r.messageCenter.enterRecipient);return}if(a.broadcast_type==="selected"&&a.selected_users.length===0){m.error(r.messageCenter.selectRecipients);return}try{let s=[];if(a.broadcast_type==="single"){const l=a.recipient_type==="user"?"users":"partners",{data:b,error:j}=await d.from(l).select("id, username").eq("username",a.recipient_username.trim()).single();if(j||!b){m.error(r.messageCenter.recipientNotFound);return}s=[b]}else if(a.broadcast_type==="selected"){const l=a.recipient_type==="user"?"users":"partners",{data:b,error:j}=await d.from(l).select("id, username").in("username",a.selected_users);if(j){m.error(r.messageCenter.recipientLoadFailed);return}s=b||[]}else if(a.broadcast_type==="all"){const l=a.recipient_type==="user"?"users":"partners",{data:b,error:j}=await d.from(l).select("id, username");if(j){m.error(r.messageCenter.allRecipientsLoadFailed);return}s=b||[]}if(s.length===0){m.error(r.messageCenter.noRecipientsToSend);return}const t=s.map(l=>({sender_type:"partner",sender_id:w.id,receiver_type:a.recipient_type,receiver_id:l.id,subject:a.title||null,content:a.content.trim(),message_type:a.message_type})),{error:n}=await d.from("messages").insert(t);if(n)throw n;const x=s.length;m.success(r.messageCenter.messageSentToCount.replace("{count}",x.toString())),J&&s.forEach(l=>{J("new_message",{recipient_type:a.recipient_type,recipient_id:l.id,title:a.title,content:a.content})}),u({recipient_type:"user",recipient_username:"",broadcast_type:"single",selected_users:[],title:"",content:"",message_type:"normal"}),z(!1),N(!1),_()}catch(s){console.error("ë©”ì‹œì§€ ì „ì†¡ ì˜¤ë¥˜:",s),m.error(r.messageCenter.messageSendFailed)}},fe=async()=>{if(!f||!A.trim()){m.error(r.messageCenter.enterReplyContent);return}try{const s={sender_type:"partner",sender_id:w.id,receiver_type:f.sender_type,receiver_id:f.sender_id,subject:f.title?`Re: ${f.title}`:null,content:A.trim(),message_type:"normal",parent_id:f.id},{error:t}=await d.from("messages").insert([s]);if(t)throw t;m.success(r.messageCenter.replySent),V(""),N(!1),_()}catch(s){console.error("ë‹µì¥ ì „ì†¡ ì˜¤ë¥˜:",s),m.error(r.messageCenter.replyFailed)}};i.useEffect(()=>{$&&$.type==="new_message"&&(m.info(r.messageCenter.newMessageArrived),_())},[$]),i.useEffect(()=>{_()},[c,M,T]),i.useEffect(()=>{const s=setTimeout(()=>{y!==void 0&&_()},300);return()=>clearTimeout(s)},[y]);const ve=[{key:"sender_username",title:c==="received"?r.messageCenter.sender:r.messageCenter.recipient,render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:c==="received"?t.sender_username:t.recipient_username}),e.jsx("div",{className:"text-xs text-muted-foreground",children:c==="received"?t.sender_type:t.recipient_type})]})]})},{key:"title",title:r.messageCenter.subject+"/"+r.messageCenter.content,render:(s,t)=>e.jsxs("div",{className:`${!t.is_read&&c==="received"?"font-semibold":""}`,children:[e.jsx("div",{className:"text-sm",children:s||r.messageCenter.noTitle}),e.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[300px]",children:t.content}),t.reply_count>0&&e.jsx(X,{variant:"outline",className:"text-xs mt-1",children:r.messageCenter.replyCount.replace("{count}",t.reply_count.toString())})]})},{key:"message_type",title:r.messageCenter.type,render:s=>{const t={normal:{label:r.messageCenter.normalMessage,variant:"secondary"},system:{label:r.messageCenter.systemMessage,variant:"outline"},urgent:{label:r.messageCenter.urgentMessage,variant:"destructive"}},n=t[s]||t.normal;return e.jsx(X,{variant:n.variant,children:n.label})}},{key:"is_read",title:r.messageCenter.status,render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-1",children:[s?e.jsx(ne,{className:"h-4 w-4 text-green-600"}):e.jsx(ie,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-xs",children:s?r.messageCenter.read:r.messageCenter.notRead})]})},{key:"created_at",title:r.messageCenter.date,render:s=>e.jsxs("div",{className:"text-sm",children:[new Date(s).toLocaleDateString("ko-KR"),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s).toLocaleTimeString("ko-KR")})]})},{key:"actions",title:r.common.actions,render:(s,t)=>e.jsxs(Z,{open:Q&&f?.id===t.id,onOpenChange:n=>{N(n),n?(I(t),V(""),z(!1),!t.is_read&&c==="received"&&je(t.id)):I(null)},children:[e.jsx(ee,{asChild:!0,children:e.jsxs(g,{size:"sm",variant:"outline",className:"h-8 px-3 flex items-center gap-1",children:[e.jsx(E,{className:"h-4 w-4"}),"ë³´ê¸°"]})}),e.jsxs(se,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsxs(ae,{children:[c==="received"?"ë°›ì€ ë©”ì‹œì§€":"ë³´ë‚¸ ë©”ì‹œì§€"," - ",t.title||"(ì œëª© ì—†ìŒ)"]}),e.jsxs(re,{children:["ë©”ì‹œì§€ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ",c==="received"?"ë‹µì¥ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤":"ì „ì†¡ëœ ë©”ì‹œì§€ì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤","."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(p,{children:"ë°œì‹ ì"}),e.jsx("p",{className:"text-sm font-medium",children:t.sender_username})]}),e.jsxs("div",{children:[e.jsx(p,{children:"ìˆ˜ì‹ ì"}),e.jsx("p",{className:"text-sm font-medium",children:t.recipient_username})]}),e.jsxs("div",{children:[e.jsx(p,{children:"ì „ì†¡ì¼ì‹œ"}),e.jsx("p",{className:"text-sm",children:new Date(t.created_at).toLocaleString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx(p,{children:"ë©”ì‹œì§€ ìœ í˜•"}),e.jsx("p",{className:"text-sm",children:t.message_type})]})]}),e.jsxs("div",{children:[e.jsx(p,{children:"ë©”ì‹œì§€ ë‚´ìš©"}),e.jsx("div",{className:"p-3 bg-muted rounded-md mt-1",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:t.content})})]}),c==="received"&&e.jsxs("div",{children:[e.jsx(p,{htmlFor:"reply",children:"ë‹µì¥ ì‘ì„±"}),e.jsx(Y,{id:"reply",placeholder:"ë‹µì¥ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...",value:A,onChange:n=>V(n.target.value),rows:4,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(g,{variant:"outline",onClick:()=>N(!1),children:"ë‹«ê¸°"}),c==="received"&&e.jsxs(g,{onClick:fe,disabled:!A.trim(),children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"ë‹µì¥ ë³´ë‚´ê¸°"]})]})]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:r.messageCenter.title}),e.jsx("p",{className:"text-sm text-slate-400",children:r.messageCenter.subtitle})]}),e.jsxs(Z,{open:Q&&ue,onOpenChange:s=>{N(s),s?(z(!0),I(null),L("")):(L(""),O([]),q([]))},children:[e.jsx(ee,{asChild:!0,children:e.jsxs(g,{className:"btn-premium-primary",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),r.messageCenter.newMessage]})}),e.jsxs(se,{className:"!max-w-[800px] w-[95vw] max-h-[85vh] overflow-hidden glass-card p-0 flex flex-col",children:[e.jsxs(te,{className:"pb-5 border-b border-slate-700/50 bg-gradient-to-r from-blue-500/10 to-purple-500/10 px-8 pt-6 rounded-t-lg bg-slate-900 backdrop-blur-xl flex-shrink-0",children:[e.jsxs(ae,{className:"flex items-center gap-3 text-2xl text-slate-50",children:[e.jsx("div",{className:"p-2.5 bg-blue-500/20 rounded-lg",children:e.jsx(K,{className:"h-7 w-7 text-blue-400"})}),r.messageCenter.composeNewMessage]}),e.jsx(re,{className:"text-slate-300 mt-2 text-base",children:r.messageCenter.composeNewMessageDesc})]}),e.jsxs("div",{className:"px-8 py-6 space-y-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-blue-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:r.messageCenter.sendSettings})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(p,{htmlFor:"recipient_type",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(Se,{className:"h-3.5 w-3.5 text-blue-400"}),"ìˆ˜ì‹ ì ìœ í˜•"]}),e.jsxs(S,{value:a.recipient_type,onValueChange:s=>{u(t=>({...t,recipient_type:s,recipient_username:"",selected_users:[]})),O([])},children:[e.jsx(k,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-blue-500 transition-colors",children:e.jsx(D,{})}),e.jsxs(F,{className:"bg-slate-900 border-slate-700",children:[e.jsx(o,{value:"user",children:"ğŸ‘¤ ì‚¬ìš©ì"}),e.jsx(o,{value:"partner",children:"ğŸ¤ ê´€ë¦¬ì"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(p,{htmlFor:"broadcast_type",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(ke,{className:"h-3.5 w-3.5 text-blue-400"}),"ì „ì†¡ ë°©ì‹"]}),e.jsxs(S,{value:a.broadcast_type,onValueChange:s=>{u(t=>({...t,broadcast_type:s,recipient_username:"",selected_users:[]})),(s==="selected"||s==="all")&&ge()},children:[e.jsx(k,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-blue-500 transition-colors",children:e.jsx(D,{})}),e.jsxs(F,{className:"bg-slate-900 border-slate-700",children:[e.jsx(o,{value:"single",children:"ğŸ“§ ê°œë³„ ì „ì†¡"}),e.jsx(o,{value:"selected",children:"ğŸ“¬ ì„ íƒ ì „ì†¡"}),e.jsx(o,{value:"all",children:"ğŸ“¢ ì „ì²´ ì „ì†¡"})]})]})]})]})]}),a.broadcast_type==="single"&&e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ìˆ˜ì‹ ì ì •ë³´"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(p,{htmlFor:"recipient_username",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(le,{className:"h-3.5 w-3.5 text-green-400"}),"ìˆ˜ì‹ ì ê²€ìƒ‰"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(U,{id:"recipient_username",value:a.recipient_username,onChange:s=>u(t=>({...t,recipient_username:s.target.value})),placeholder:"ìˆ˜ì‹ ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: smcdev111)",className:"pl-9 input-premium h-11 bg-slate-800/50 border-slate-600 focus:border-green-500"})]}),e.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-300 flex items-center gap-2",children:[e.jsx(De,{className:"h-3.5 w-3.5"}),'ì‚¬ìš©ìê°€ ë§ì€ ê²½ìš° "ì„ íƒ ì „ì†¡"ì„ ì´ìš©í•˜ì‹œë©´ ê²€ìƒ‰í•˜ì—¬ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.']})})]})]}),a.broadcast_type==="selected"&&e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ìˆ˜ì‹ ì ì„ íƒ"})]}),e.jsxs("div",{className:"space-y-3",children:[he?e.jsxs("div",{className:"flex items-center justify-center p-8 text-slate-400",children:[e.jsx("div",{className:"loading-premium w-8 h-8"}),e.jsx("span",{className:"ml-3",children:"ì‚¬ìš©ì ëª©ë¡ ë¡œë”© ì¤‘..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(U,{value:C,onChange:s=>L(s.target.value),placeholder:"ì‚¬ìš©ì IDë¡œ ê²€ìƒ‰...",className:"pl-9 input-premium"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-slate-300",children:[R.length,"ëª… í‘œì‹œ ì¤‘ / ì´ ",h.length,"ëª…"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{const s=R.map(t=>t.username);u(t=>({...t,selected_users:Array.from(new Set([...t.selected_users,...s]))}))},className:"btn-premium-success text-xs px-2 py-1 h-7",children:"í˜„ì¬ í˜ì´ì§€ ì „ì²´ ì„ íƒ"}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>{u(s=>({...s,selected_users:[]}))},className:"text-xs px-2 py-1 h-7",children:"ì „ì²´ í•´ì œ"})]})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto border border-slate-600 rounded-lg bg-slate-900/50 p-3 space-y-1",children:[R.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-slate-800/50 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a.selected_users.includes(s.username),onChange:t=>{const n=s.username;t.target.checked?u(x=>({...x,selected_users:[...x.selected_users,n]})):u(x=>({...x,selected_users:x.selected_users.filter(l=>l!==n)}))},className:"rounded w-4 h-4"}),e.jsx("span",{className:"text-sm text-slate-200",children:s.username})]},s.id)),R.length===0&&e.jsx("div",{className:"text-center text-sm text-slate-500 py-8",children:C?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.":"ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤."})]})]}),a.selected_users.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-900/30 border border-blue-600/30 rounded-lg",children:[e.jsxs("div",{className:"text-sm text-blue-300 flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("strong",{children:"ì„ íƒëœ ì‚¬ìš©ì:"})," ",a.selected_users.length,"ëª…"]}),e.jsx("div",{className:"text-xs text-blue-400 mt-2 max-h-24 overflow-y-auto",children:a.selected_users.join(", ")})]})]})]}),a.broadcast_type==="all"&&e.jsxs("div",{className:"space-y-4 p-5 border border-yellow-500/50 rounded-xl bg-gradient-to-br from-yellow-900/20 to-yellow-800/10 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-yellow-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ì „ì²´ ì „ì†¡ í™•ì¸"})]}),e.jsxs("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-300 mb-2",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"ì£¼ì˜ì‚¬í•­"})]}),e.jsxs("p",{className:"text-sm text-yellow-200",children:["ëª¨ë“  ",a.recipient_type==="user"?"ì‚¬ìš©ì":"ê´€ë¦¬ì","ì—ê²Œ ë©”ì‹œì§€ê°€ ì „ì†¡ë©ë‹ˆë‹¤.",h.length>0&&e.jsxs("span",{className:"font-semibold",children:[" (ì´ ",h.length,"ëª…)"]})]}),h.length>0&&h.length<=10&&e.jsxs("div",{className:"mt-2 text-xs text-yellow-300",children:["ëŒ€ìƒ: ",h.map(s=>s.username).join(", ")]})]})]}),e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-purple-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ë©”ì‹œì§€ ë‚´ìš©"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(p,{htmlFor:"new_title",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(Me,{className:"h-3.5 w-3.5 text-purple-400"}),"ì œëª©"]}),e.jsx(U,{id:"new_title",value:a.title,onChange:s=>u(t=>({...t,title:s.target.value})),placeholder:"ë©”ì‹œì§€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)",className:"input-premium h-11 bg-slate-800/50 border-slate-600 focus:border-purple-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(p,{htmlFor:"new_content",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(E,{className:"h-3.5 w-3.5 text-purple-400"}),"ë‚´ìš© *"]}),e.jsx(Y,{id:"new_content",value:a.content,onChange:s=>u(t=>({...t,content:s.target.value})),placeholder:"ë©”ì‹œì§€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”",rows:6,className:"input-premium bg-slate-800/50 border-slate-600 focus:border-purple-500 resize-none"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(p,{htmlFor:"message_type",className:"text-slate-200",children:"ë©”ì‹œì§€ ìœ í˜•"}),e.jsxs(S,{value:a.message_type,onValueChange:s=>u(t=>({...t,message_type:s})),children:[e.jsx(k,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-purple-500 transition-colors",children:e.jsx(D,{})}),e.jsxs(F,{className:"bg-slate-900 border-slate-700",children:[e.jsx(o,{value:"normal",children:"ğŸ’¬ ì¼ë°˜"}),e.jsx(o,{value:"system",children:"âš™ï¸ ì‹œìŠ¤í…œ"}),e.jsx(o,{value:"urgent",children:"ğŸš¨ ê¸´ê¸‰"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-slate-700/50 px-8 pb-6 bg-slate-900 backdrop-blur-xl flex-shrink-0",children:[e.jsxs(g,{onClick:be,disabled:!a.content.trim()||a.broadcast_type==="single"&&!a.recipient_username.trim()||a.broadcast_type==="selected"&&a.selected_users.length===0,className:"btn-premium-primary flex items-center gap-3 flex-1 h-12 text-base shadow-lg shadow-blue-500/20 hover:shadow-blue-500/40 transition-all",children:[e.jsx(K,{className:"h-5 w-5"}),"ì „ì†¡",a.broadcast_type==="single"&&" (1ëª…)",a.broadcast_type==="selected"&&` (${a.selected_users.length}ëª…)`,a.broadcast_type==="all"&&` (${h.length}ëª…)`]}),e.jsx(g,{onClick:()=>N(!1),variant:"outline",className:"border-slate-600 hover:bg-slate-700/50 h-12 px-8 text-base",children:"ì·¨ì†Œ"})]})]})]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-slate-700/50",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-100 flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-blue-400"}),r.messageCenter.messageList]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:r.messageCenter.messageListDesc})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:c==="received"?"default":"outline",onClick:()=>P("received"),className:c==="received"?"btn-premium-primary":"",children:"ë°›ì€ ë©”ì‹œì§€"}),e.jsx(g,{variant:c==="sent"?"default":"outline",onClick:()=>P("sent"),className:c==="sent"?"btn-premium-primary":"",children:"ë³´ë‚¸ ë©”ì‹œì§€"})]}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(U,{placeholder:"ì œëª©, ë‚´ìš©ìœ¼ë¡œ ê²€ìƒ‰...",value:y,onChange:s=>pe(s.target.value),className:"pl-9 input-premium"})]})}),e.jsxs(S,{value:M,onValueChange:me,children:[e.jsx(k,{className:"w-[120px] bg-slate-800/50 border-slate-600",children:e.jsx(D,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"all",children:"ì „ì²´ ìœ í˜•"}),e.jsx(o,{value:"normal",children:"ì¼ë°˜"}),e.jsx(o,{value:"system",children:"ì‹œìŠ¤í…œ"}),e.jsx(o,{value:"urgent",children:"ê¸´ê¸‰"})]})]}),c==="received"&&e.jsxs(S,{value:T,onValueChange:xe,children:[e.jsx(k,{className:"w-[120px] bg-slate-800/50 border-slate-600",children:e.jsx(D,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"all",children:"ì „ì²´"}),e.jsx(o,{value:"unread",children:"ì•ˆì½ìŒ"}),e.jsx(o,{value:"read",children:"ì½ìŒ"})]})]})]}),de?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(_e,{})}):e.jsx(we,{data:oe,columns:ve,enableSearch:!1})]})]})]})}export{Oe as MessageCenter,Oe as default};
