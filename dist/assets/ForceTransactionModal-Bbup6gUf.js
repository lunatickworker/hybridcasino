import{r as g,j as e}from"./react-core-BwkdTuSg.js";import{a as B,u as U,L as b,S as V,o as z,p as q,q as G,r as S,h as v,I as ee,z as se}from"./index-Be3DOFuy.js";import{P as te,a as ae,b as le}from"./popover-BEBhnF_B.js";import{C as ie,a as ne,e as oe,b as de,c as re,d as me}from"./command-B168hacb.js";import{A as ce,a as xe,b as he,c as je,d as pe,e as fe}from"./AdminDialog-6C2SLoqm.js";import{T as ge,j as be,ai as ue,l as Ne,ag as ve}from"./lucide-icons-D2Pw2Rdn.js";function Ie({open:H,onOpenChange:F,type:i,targetType:h,selectedTarget:w,targets:L=[],onSubmit:R,onTypeChange:W,currentUserLevel:m,currentUserBalance:P=0,currentUserInvestBalance:t=0,currentUserOroplayBalance:n=0}){const{t:we}=B(),{useInvestApi:o,useOroplayApi:d}=U(),[u,C]=g.useState(""),[j,p]=g.useState(""),[T,y]=g.useState(""),[k,D]=g.useState(!1),[_,M]=g.useState(!1),J=o?"invest":"oroplay",[x,$]=g.useState(J),K=[1e3,3e3,5e3,1e4,3e4,5e4,1e5,3e5,5e5,1e6],a=w||L.find(s=>s.id===u),N=a?parseFloat(a.balance?.toString()||"0"):0,I=!!w,E=h==="partner"&&m===1&&a?.level===2,Q=s=>{const l=parseFloat(j||"0")+s;p(l.toString())},X=s=>{p(s)},f=parseFloat(j||"0"),A=m===1&&a?.level===2;m===1&&a?.level,m===2&&a?.level;let c="";if(a&&f>0&&(i==="withdrawal"&&f>N&&(c=`ì¶œê¸ˆ ê°€ëŠ¥ ê¸ˆì•¡ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (ìµœëŒ€: ${N.toLocaleString()}ì›)`),i==="deposit"))if(m===1&&a?.level===2){const s=x==="invest"?t:n;f>s&&(c=`${x==="invest"?"Invest":"OroPlay"} API ë³´ìœ ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. (ì…ê¸ˆ ê°€ëŠ¥: ${s.toLocaleString()}ì›)`)}else if(m===1){const s=[];o&&s.push(t),d&&s.push(n);const r=s.length>0?Math.min(...s):0;if(f>r){let l="";o&&d?l=t<n?"Invest":"OroPlay":o?l="Invest":l="OroPlay",c=`${l} API ë³´ìœ ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. (ì…ê¸ˆ ê°€ëŠ¥: ${r.toLocaleString()}ì›)`}}else if(m===2){const s=[];o&&t>0&&s.push(t),d&&n>0&&s.push(n);const r=s.length>0?Math.min(...s):0;if(f>r){let l="";o&&d?t>0&&n>0?l=t<n?"Invest":"OroPlay":t>0?l="Invest":l="OroPlay":o&&t>0?l="Invest":d&&n>0&&(l="OroPlay"),c=l?`${l} API ë³´ìœ ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. (ì…ê¸ˆ ê°€ëŠ¥: ${r.toLocaleString()}ì›)`:"ë…¸ì¶œëœ ê²Œì„ì‚¬ì˜ ë³´ìœ ê¸ˆì´ ì—†ìŠµë‹ˆë‹¤."}}else f>P&&(c=`ë³´ìœ ê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. (í˜„ì¬: ${P.toLocaleString()}ì›)`);const Y=()=>{p("0")},Z=()=>{a&&i==="withdrawal"&&p(N.toString())},O=async()=>{const s=w?.id||u;if(!s||c)return;const r=parseFloat(j||"0");if(!(r<=0))try{M(!0),await R({targetId:s,type:i,amount:r,memo:T,apiType:E?x:void 0}),I||C(""),p(""),y(""),$("invest"),F(!1)}catch(l){console.error("ê°•ì œ ì…ì¶œê¸ˆ ì‹¤í–‰ ì˜¤ë¥˜:",l)}finally{M(!1)}};return e.jsx(ce,{open:H,onOpenChange:s=>{s||(I||C(""),p(""),y(""),$("invest")),F(s)},children:e.jsxs(xe,{className:"sm:max-w-[550px]",children:[e.jsxs(he,{children:[e.jsx(je,{className:"flex items-center gap-2",children:i==="deposit"?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-5 w-5 text-emerald-500"}),"ê°•ì œ ì…ê¸ˆ"]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-5 w-5 text-rose-500"}),"ê°•ì œ ì¶œê¸ˆ"]})}),e.jsxs(pe,{children:[h==="user"?"íšŒì›":"íŒŒíŠ¸ë„ˆ","ì˜ ì”ì•¡ì„ ì§ì ‘ ì¡°ì •í•©ë‹ˆë‹¤."]})]}),e.jsxs("div",{className:"grid gap-5 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"force-transaction-type",children:"ê±°ë˜ ìœ í˜•"}),e.jsxs(V,{value:i,onValueChange:s=>W(s),children:[e.jsx(z,{id:"force-transaction-type",className:"input-premium h-10",children:e.jsx(q,{})}),e.jsxs(G,{className:"bg-slate-800 border-slate-700",children:[e.jsx(S,{value:"deposit",children:"ì…ê¸ˆ"}),e.jsx(S,{value:"withdrawal",children:"ì¶œê¸ˆ"})]})]})]}),!I&&e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(b,{htmlFor:"force-transaction-target-search",children:[h==="user"?"íšŒì›":"íŒŒíŠ¸ë„ˆ"," ì„ íƒ"]}),e.jsxs(te,{open:k,onOpenChange:D,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(v,{id:"force-transaction-target-search",variant:"outline",role:"combobox","aria-expanded":k,className:"justify-between input-premium h-10",children:[u?`${a?.username} (${a?.nickname}) - ${N.toLocaleString()}ì›`:"ì•„ì´ë””, ë‹‰ë„¤ì„ìœ¼ë¡œ ê²€ìƒ‰",e.jsx(ue,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(le,{className:"w-[480px] p-0 bg-slate-800 border-slate-700",children:e.jsxs(ie,{className:"bg-slate-800",children:[e.jsx(ne,{placeholder:"ì•„ì´ë””, ë‹‰ë„¤ì„ìœ¼ë¡œ ê²€ìƒ‰...",className:"h-9 text-slate-100 placeholder:text-slate-500"}),e.jsxs(oe,{children:[e.jsxs(de,{className:"text-slate-400 py-6 text-center text-sm",children:[h==="user"?"íšŒì›":"íŒŒíŠ¸ë„ˆ","ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]}),e.jsx(re,{className:"max-h-64 overflow-auto",children:L.map(s=>e.jsxs(me,{value:`${s.username} ${s.nickname}`,onSelect:()=>{C(s.id),D(!1)},className:"flex items-center justify-between cursor-pointer hover:bg-slate-700/50 text-slate-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:`mr-2 h-4 w-4 ${u===s.id?`opacity-100 ${i==="deposit"?"text-emerald-500":"text-rose-500"}`:"opacity-0"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-100",children:s.username}),e.jsx("div",{className:"text-xs text-slate-400",children:s.nickname})]})]}),e.jsx("div",{className:"text-sm",children:e.jsxs("span",{className:"text-cyan-400 font-mono",children:[parseFloat(s.balance?.toString()||"0").toLocaleString(),"ì›"]})})]},s.id))})]})]})})]})]}),a&&e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:["ì„ íƒëœ ",h==="user"?"íšŒì›":"íŒŒíŠ¸ë„ˆ"]}),e.jsx("span",{className:"text-cyan-400 font-medium",children:a.nickname})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-slate-400",children:[h==="user"?"íšŒì›":"íŒŒíŠ¸ë„ˆ"," ì”ê³ "]}),e.jsxs("span",{className:"font-mono text-cyan-400",children:[N.toLocaleString(),"ì›"]})]}),a.level===2&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-700",children:e.jsx("p",{className:"text-[10px] text-slate-500",children:"â€» Lv2ëŠ” ë‘ ê°œì˜ ì§€ê°‘(invest_balance, oroplay_balance)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤."})}),a.level===3&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-700",children:e.jsx("p",{className:"text-[10px] text-slate-500",children:"â€» Lv3ëŠ” ë‹¨ì¼ ì§€ê°‘(balance)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤."})})]}),i==="deposit"&&e.jsxs("div",{className:"p-3 bg-emerald-900/20 rounded-lg border border-emerald-700/50",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:"text-sm text-emerald-400",children:"ğŸ’° ê´€ë¦¬ì ë³´ìœ ê¸ˆ (ì…ê¸ˆ ê°€ëŠ¥ ê¸ˆì•¡)"})}),m===1?e.jsxs("div",{className:"space-y-1.5",children:[o&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Invest API:"}),e.jsxs("span",{className:`font-mono text-sm ${A&&x==="invest"?"text-emerald-400 font-bold":"text-emerald-400/60"}`,children:[t.toLocaleString(),"ì›"]})]}),d&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"OroPlay API:"}),e.jsxs("span",{className:`font-mono text-sm ${A&&x==="oroplay"?"text-emerald-400 font-bold":"text-emerald-400/60"}`,children:[n.toLocaleString(),"ì›"]})]}),A?e.jsxs("div",{className:"pt-1.5 mt-1.5 border-t border-emerald-700/30 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-emerald-400",children:"ì…ê¸ˆ ê°€ëŠ¥ (ì„ íƒí•œ API):"}),e.jsxs("span",{className:"font-mono text-emerald-400 font-bold",children:[(x==="invest"?t:n).toLocaleString(),"ì›"]})]}):e.jsxs("div",{className:"pt-1.5 mt-1.5 border-t border-emerald-700/30 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-emerald-400",children:"ì…ê¸ˆ ê°€ëŠ¥ (ìµœì†Œê°’):"}),e.jsxs("span",{className:"font-mono text-emerald-400 font-bold",children:[(()=>{const s=[];return o&&s.push(t),d&&s.push(n),s.length>0?Math.min(...s).toLocaleString():"0"})(),"ì›"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:A?"â€» ì„ íƒí•œ API ë³´ìœ ê¸ˆì—ì„œë§Œ ì…ê¸ˆë©ë‹ˆë‹¤.":o&&d?"â€» ë‘ API ì¤‘ ê°€ì¥ ì‘ì€ ë³´ìœ ê¸ˆì„ ê¸°ì¤€ìœ¼ë¡œ ì…ê¸ˆ ì œí•œë©ë‹ˆë‹¤.":"â€» í™œì„±í™”ëœ API ë³´ìœ ê¸ˆì„ ê¸°ì¤€ìœ¼ë¡œ ì…ê¸ˆ ì œí•œë©ë‹ˆë‹¤."})]}):m===2?e.jsxs("div",{className:"space-y-1.5",children:[o&&t>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Invest API:"}),e.jsxs("span",{className:"font-mono text-sm text-emerald-400",children:[t.toLocaleString(),"ì›"]})]}),d&&n>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"OroPlay API:"}),e.jsxs("span",{className:"font-mono text-sm text-emerald-400",children:[n.toLocaleString(),"ì›"]})]}),e.jsxs("div",{className:"pt-1.5 mt-1.5 border-t border-emerald-700/30 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-emerald-400",children:"ì…ê¸ˆ ê°€ëŠ¥:"}),e.jsxs("span",{className:"font-mono text-emerald-400 font-bold",children:[(()=>{const s=[];return o&&t>0&&s.push(t),d&&n>0&&s.push(n),s.length>0?Math.min(...s).toLocaleString():"ê³„ì‚° ì—†ìŒ"})(),"ì›"]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"â€» Lv2 ì…ê¸ˆ ì‹œ Lv2 ë¶ˆìš©ê¸ˆì„ í™œìš©í•©ë‹ˆë‹¤."})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"ì‚¬ìš© ê°€ëŠ¥:"}),e.jsxs("span",{className:"font-mono text-emerald-400",children:[P.toLocaleString(),"ì›"]})]})]}),E&&e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(b,{htmlFor:"api-type-select",children:[i==="deposit"?"ì…ê¸ˆí• ":"íšŒìˆ˜í• "," API ì„ íƒ"]}),e.jsxs(V,{value:x,onValueChange:s=>$(s),children:[e.jsx(z,{id:"api-type-select",className:"input-premium h-10",children:e.jsx(q,{})}),e.jsxs(G,{className:"bg-slate-800 border-slate-700",children:[o&&e.jsx(S,{value:"invest",children:"Invest API"}),d&&e.jsx(S,{value:"oroplay",children:"OroPlay API"})]})]}),e.jsx("p",{className:"text-xs text-slate-500",children:i==="deposit"?"ì„ íƒí•œ APIë¡œë§Œ ì…ê¸ˆë©ë‹ˆë‹¤.":"ì„ íƒí•œ APIì˜ ë³´ìœ ê¸ˆì—ì„œë§Œ ì¶œê¸ˆë©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(b,{htmlFor:"force-transaction-amount",children:"ê¸ˆì•¡"}),e.jsx(v,{type:"button",variant:"ghost",size:"sm",onClick:Y,className:`h-7 px-2 text-xs text-slate-400 ${i==="deposit"?"hover:text-orange-400 hover:bg-orange-500/10":"hover:text-red-400 hover:bg-red-500/10"}`,children:"ì „ì²´ì‚­ì œ"})]}),e.jsx(ee,{id:"force-transaction-amount",name:"amount",type:"number",value:j,onChange:s=>X(s.target.value),className:"input-premium",placeholder:"ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{className:"text-slate-400 text-sm",children:"ë‹¨ì¶• ì…ë ¥ (ëˆ„ì  ë”í•˜ê¸°)"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:K.map(s=>e.jsxs(v,{type:"button",variant:"outline",onClick:()=>Q(s),className:`h-9 transition-all bg-slate-800/50 border-slate-700 text-slate-300 ${i==="deposit"?"hover:bg-orange-500/20 hover:border-orange-500/60 hover:text-orange-400 hover:shadow-[0_0_15px_rgba(251,146,60,0.3)]":"hover:bg-red-500/20 hover:border-red-500/60 hover:text-red-400 hover:shadow-[0_0_15px_rgba(239,68,68,0.3)]"}`,children:["+",s>=1e4?`${s/1e4}ë§Œ`:`${s/1e3}ì²œ`]},s))})]}),i==="withdrawal"&&a&&e.jsx("div",{className:"grid gap-2",children:e.jsxs(v,{type:"button",variant:"outline",onClick:Z,className:"w-full h-9 bg-red-900/20 border-red-500/50 text-red-400 hover:bg-red-900/40 hover:border-red-500",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"ì „ì•¡ì¶œê¸ˆ"]})}),c&&e.jsx("div",{className:"p-3 bg-rose-900/20 border border-rose-500/50 rounded-lg",children:e.jsx("p",{className:"text-sm text-rose-400",children:c})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{htmlFor:"force-transaction-memo",children:"ë©”ëª¨"}),e.jsx(se,{id:"force-transaction-memo",name:"memo",value:T,onChange:s=>y(s.target.value),placeholder:"ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)",className:"input-premium min-h-[80px]"})]})]}),e.jsx(fe,{children:e.jsx(v,{type:"button",onClick:O,disabled:_||!w?.id&&!u||!j||parseFloat(j)<=0||!!c,className:`w-full ${i==="deposit"?"btn-premium-warning":"btn-premium-danger"}`,children:_?"ì²˜ë¦¬ ì¤‘...":i==="deposit"?"ê°•ì œ ì…ê¸ˆ":"ê°•ì œ ì¶œê¸ˆ"})})]})})}export{Ie as F};
